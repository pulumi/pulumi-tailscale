// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package tailscale

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-tailscale/sdk/go/tailscale/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// The federatedIdentity resource allows you to create federated identities to programmatically interact with the Tailscale API using workload identity federation.
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-tailscale/sdk/go/tailscale"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := tailscale.NewFederatedIdentity(ctx, "example_federated_identity", &tailscale.FederatedIdentityArgs{
//				Description: pulumi.String("Example federated identity"),
//				Scopes: pulumi.StringArray{
//					pulumi.String("auth_keys"),
//					pulumi.String("devices:core"),
//				},
//				Tags: pulumi.StringArray{
//					pulumi.String("tag:test"),
//				},
//				Issuer:  pulumi.String("https://example.com"),
//				Subject: pulumi.String("example-sub-*"),
//				CustomClaimRules: pulumi.StringMap{
//					"repo_name": pulumi.String("example-repo-name"),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// The `pulumi import` command can be used, for example:
//
// ```sh
// $ pulumi import tailscale:index/federatedIdentity:FederatedIdentity example k1234511CNTRL-kZDRvszg8621CNTRL
// ```
type FederatedIdentity struct {
	pulumi.CustomResourceState

	// The value used when matching against the `aud` claim from an OIDC identity token. Specifying the audience is optional as Tailscale will generate a secure audience at creation time by default.   It is recommended to let Tailscale generate the audience unless the identity provider you are integrating with requires a specific audience format.
	Audience pulumi.StringOutput `pulumi:"audience"`
	// The creation timestamp of the key in RFC3339 format
	CreatedAt pulumi.StringOutput `pulumi:"createdAt"`
	// A map of claim names to pattern strings used to match against arbitrary claims in the OIDC identity token. Patterns can include `*` characters to match against any character.
	CustomClaimRules pulumi.StringMapOutput `pulumi:"customClaimRules"`
	// A description of the federated identity consisting of alphanumeric characters. Defaults to `""`.
	Description pulumi.StringPtrOutput `pulumi:"description"`
	// The issuer of the OIDC identity token used in the token exchange. Must be a valid and publicly reachable https:// URL.
	Issuer pulumi.StringOutput `pulumi:"issuer"`
	// Scopes to grant to the federated identity. See https://tailscale.com/kb/1623/ for a list of available scopes.
	Scopes pulumi.StringArrayOutput `pulumi:"scopes"`
	// The pattern used when matching against the `sub` claim from an OIDC identity token. Patterns can include `*` characters to match against any character.
	Subject pulumi.StringOutput `pulumi:"subject"`
	// A list of tags that access tokens generated for the federated identity will be able to assign to devices. Mandatory if the scopes include "devices:core" or "authKeys".
	Tags pulumi.StringArrayOutput `pulumi:"tags"`
	// The updated timestamp of the key in RFC3339 format
	UpdatedAt pulumi.StringOutput `pulumi:"updatedAt"`
	// ID of the user who created this federated identity, empty for federated identities created by other trust credentials.
	UserId pulumi.StringOutput `pulumi:"userId"`
}

// NewFederatedIdentity registers a new resource with the given unique name, arguments, and options.
func NewFederatedIdentity(ctx *pulumi.Context,
	name string, args *FederatedIdentityArgs, opts ...pulumi.ResourceOption) (*FederatedIdentity, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Issuer == nil {
		return nil, errors.New("invalid value for required argument 'Issuer'")
	}
	if args.Scopes == nil {
		return nil, errors.New("invalid value for required argument 'Scopes'")
	}
	if args.Subject == nil {
		return nil, errors.New("invalid value for required argument 'Subject'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource FederatedIdentity
	err := ctx.RegisterResource("tailscale:index/federatedIdentity:FederatedIdentity", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetFederatedIdentity gets an existing FederatedIdentity resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetFederatedIdentity(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *FederatedIdentityState, opts ...pulumi.ResourceOption) (*FederatedIdentity, error) {
	var resource FederatedIdentity
	err := ctx.ReadResource("tailscale:index/federatedIdentity:FederatedIdentity", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering FederatedIdentity resources.
type federatedIdentityState struct {
	// The value used when matching against the `aud` claim from an OIDC identity token. Specifying the audience is optional as Tailscale will generate a secure audience at creation time by default.   It is recommended to let Tailscale generate the audience unless the identity provider you are integrating with requires a specific audience format.
	Audience *string `pulumi:"audience"`
	// The creation timestamp of the key in RFC3339 format
	CreatedAt *string `pulumi:"createdAt"`
	// A map of claim names to pattern strings used to match against arbitrary claims in the OIDC identity token. Patterns can include `*` characters to match against any character.
	CustomClaimRules map[string]string `pulumi:"customClaimRules"`
	// A description of the federated identity consisting of alphanumeric characters. Defaults to `""`.
	Description *string `pulumi:"description"`
	// The issuer of the OIDC identity token used in the token exchange. Must be a valid and publicly reachable https:// URL.
	Issuer *string `pulumi:"issuer"`
	// Scopes to grant to the federated identity. See https://tailscale.com/kb/1623/ for a list of available scopes.
	Scopes []string `pulumi:"scopes"`
	// The pattern used when matching against the `sub` claim from an OIDC identity token. Patterns can include `*` characters to match against any character.
	Subject *string `pulumi:"subject"`
	// A list of tags that access tokens generated for the federated identity will be able to assign to devices. Mandatory if the scopes include "devices:core" or "authKeys".
	Tags []string `pulumi:"tags"`
	// The updated timestamp of the key in RFC3339 format
	UpdatedAt *string `pulumi:"updatedAt"`
	// ID of the user who created this federated identity, empty for federated identities created by other trust credentials.
	UserId *string `pulumi:"userId"`
}

type FederatedIdentityState struct {
	// The value used when matching against the `aud` claim from an OIDC identity token. Specifying the audience is optional as Tailscale will generate a secure audience at creation time by default.   It is recommended to let Tailscale generate the audience unless the identity provider you are integrating with requires a specific audience format.
	Audience pulumi.StringPtrInput
	// The creation timestamp of the key in RFC3339 format
	CreatedAt pulumi.StringPtrInput
	// A map of claim names to pattern strings used to match against arbitrary claims in the OIDC identity token. Patterns can include `*` characters to match against any character.
	CustomClaimRules pulumi.StringMapInput
	// A description of the federated identity consisting of alphanumeric characters. Defaults to `""`.
	Description pulumi.StringPtrInput
	// The issuer of the OIDC identity token used in the token exchange. Must be a valid and publicly reachable https:// URL.
	Issuer pulumi.StringPtrInput
	// Scopes to grant to the federated identity. See https://tailscale.com/kb/1623/ for a list of available scopes.
	Scopes pulumi.StringArrayInput
	// The pattern used when matching against the `sub` claim from an OIDC identity token. Patterns can include `*` characters to match against any character.
	Subject pulumi.StringPtrInput
	// A list of tags that access tokens generated for the federated identity will be able to assign to devices. Mandatory if the scopes include "devices:core" or "authKeys".
	Tags pulumi.StringArrayInput
	// The updated timestamp of the key in RFC3339 format
	UpdatedAt pulumi.StringPtrInput
	// ID of the user who created this federated identity, empty for federated identities created by other trust credentials.
	UserId pulumi.StringPtrInput
}

func (FederatedIdentityState) ElementType() reflect.Type {
	return reflect.TypeOf((*federatedIdentityState)(nil)).Elem()
}

type federatedIdentityArgs struct {
	// The value used when matching against the `aud` claim from an OIDC identity token. Specifying the audience is optional as Tailscale will generate a secure audience at creation time by default.   It is recommended to let Tailscale generate the audience unless the identity provider you are integrating with requires a specific audience format.
	Audience *string `pulumi:"audience"`
	// A map of claim names to pattern strings used to match against arbitrary claims in the OIDC identity token. Patterns can include `*` characters to match against any character.
	CustomClaimRules map[string]string `pulumi:"customClaimRules"`
	// A description of the federated identity consisting of alphanumeric characters. Defaults to `""`.
	Description *string `pulumi:"description"`
	// The issuer of the OIDC identity token used in the token exchange. Must be a valid and publicly reachable https:// URL.
	Issuer string `pulumi:"issuer"`
	// Scopes to grant to the federated identity. See https://tailscale.com/kb/1623/ for a list of available scopes.
	Scopes []string `pulumi:"scopes"`
	// The pattern used when matching against the `sub` claim from an OIDC identity token. Patterns can include `*` characters to match against any character.
	Subject string `pulumi:"subject"`
	// A list of tags that access tokens generated for the federated identity will be able to assign to devices. Mandatory if the scopes include "devices:core" or "authKeys".
	Tags []string `pulumi:"tags"`
}

// The set of arguments for constructing a FederatedIdentity resource.
type FederatedIdentityArgs struct {
	// The value used when matching against the `aud` claim from an OIDC identity token. Specifying the audience is optional as Tailscale will generate a secure audience at creation time by default.   It is recommended to let Tailscale generate the audience unless the identity provider you are integrating with requires a specific audience format.
	Audience pulumi.StringPtrInput
	// A map of claim names to pattern strings used to match against arbitrary claims in the OIDC identity token. Patterns can include `*` characters to match against any character.
	CustomClaimRules pulumi.StringMapInput
	// A description of the federated identity consisting of alphanumeric characters. Defaults to `""`.
	Description pulumi.StringPtrInput
	// The issuer of the OIDC identity token used in the token exchange. Must be a valid and publicly reachable https:// URL.
	Issuer pulumi.StringInput
	// Scopes to grant to the federated identity. See https://tailscale.com/kb/1623/ for a list of available scopes.
	Scopes pulumi.StringArrayInput
	// The pattern used when matching against the `sub` claim from an OIDC identity token. Patterns can include `*` characters to match against any character.
	Subject pulumi.StringInput
	// A list of tags that access tokens generated for the federated identity will be able to assign to devices. Mandatory if the scopes include "devices:core" or "authKeys".
	Tags pulumi.StringArrayInput
}

func (FederatedIdentityArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*federatedIdentityArgs)(nil)).Elem()
}

type FederatedIdentityInput interface {
	pulumi.Input

	ToFederatedIdentityOutput() FederatedIdentityOutput
	ToFederatedIdentityOutputWithContext(ctx context.Context) FederatedIdentityOutput
}

func (*FederatedIdentity) ElementType() reflect.Type {
	return reflect.TypeOf((**FederatedIdentity)(nil)).Elem()
}

func (i *FederatedIdentity) ToFederatedIdentityOutput() FederatedIdentityOutput {
	return i.ToFederatedIdentityOutputWithContext(context.Background())
}

func (i *FederatedIdentity) ToFederatedIdentityOutputWithContext(ctx context.Context) FederatedIdentityOutput {
	return pulumi.ToOutputWithContext(ctx, i).(FederatedIdentityOutput)
}

// FederatedIdentityArrayInput is an input type that accepts FederatedIdentityArray and FederatedIdentityArrayOutput values.
// You can construct a concrete instance of `FederatedIdentityArrayInput` via:
//
//	FederatedIdentityArray{ FederatedIdentityArgs{...} }
type FederatedIdentityArrayInput interface {
	pulumi.Input

	ToFederatedIdentityArrayOutput() FederatedIdentityArrayOutput
	ToFederatedIdentityArrayOutputWithContext(context.Context) FederatedIdentityArrayOutput
}

type FederatedIdentityArray []FederatedIdentityInput

func (FederatedIdentityArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*FederatedIdentity)(nil)).Elem()
}

func (i FederatedIdentityArray) ToFederatedIdentityArrayOutput() FederatedIdentityArrayOutput {
	return i.ToFederatedIdentityArrayOutputWithContext(context.Background())
}

func (i FederatedIdentityArray) ToFederatedIdentityArrayOutputWithContext(ctx context.Context) FederatedIdentityArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(FederatedIdentityArrayOutput)
}

// FederatedIdentityMapInput is an input type that accepts FederatedIdentityMap and FederatedIdentityMapOutput values.
// You can construct a concrete instance of `FederatedIdentityMapInput` via:
//
//	FederatedIdentityMap{ "key": FederatedIdentityArgs{...} }
type FederatedIdentityMapInput interface {
	pulumi.Input

	ToFederatedIdentityMapOutput() FederatedIdentityMapOutput
	ToFederatedIdentityMapOutputWithContext(context.Context) FederatedIdentityMapOutput
}

type FederatedIdentityMap map[string]FederatedIdentityInput

func (FederatedIdentityMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*FederatedIdentity)(nil)).Elem()
}

func (i FederatedIdentityMap) ToFederatedIdentityMapOutput() FederatedIdentityMapOutput {
	return i.ToFederatedIdentityMapOutputWithContext(context.Background())
}

func (i FederatedIdentityMap) ToFederatedIdentityMapOutputWithContext(ctx context.Context) FederatedIdentityMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(FederatedIdentityMapOutput)
}

type FederatedIdentityOutput struct{ *pulumi.OutputState }

func (FederatedIdentityOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**FederatedIdentity)(nil)).Elem()
}

func (o FederatedIdentityOutput) ToFederatedIdentityOutput() FederatedIdentityOutput {
	return o
}

func (o FederatedIdentityOutput) ToFederatedIdentityOutputWithContext(ctx context.Context) FederatedIdentityOutput {
	return o
}

// The value used when matching against the `aud` claim from an OIDC identity token. Specifying the audience is optional as Tailscale will generate a secure audience at creation time by default.   It is recommended to let Tailscale generate the audience unless the identity provider you are integrating with requires a specific audience format.
func (o FederatedIdentityOutput) Audience() pulumi.StringOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringOutput { return v.Audience }).(pulumi.StringOutput)
}

// The creation timestamp of the key in RFC3339 format
func (o FederatedIdentityOutput) CreatedAt() pulumi.StringOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringOutput { return v.CreatedAt }).(pulumi.StringOutput)
}

// A map of claim names to pattern strings used to match against arbitrary claims in the OIDC identity token. Patterns can include `*` characters to match against any character.
func (o FederatedIdentityOutput) CustomClaimRules() pulumi.StringMapOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringMapOutput { return v.CustomClaimRules }).(pulumi.StringMapOutput)
}

// A description of the federated identity consisting of alphanumeric characters. Defaults to `""`.
func (o FederatedIdentityOutput) Description() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringPtrOutput { return v.Description }).(pulumi.StringPtrOutput)
}

// The issuer of the OIDC identity token used in the token exchange. Must be a valid and publicly reachable https:// URL.
func (o FederatedIdentityOutput) Issuer() pulumi.StringOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringOutput { return v.Issuer }).(pulumi.StringOutput)
}

// Scopes to grant to the federated identity. See https://tailscale.com/kb/1623/ for a list of available scopes.
func (o FederatedIdentityOutput) Scopes() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringArrayOutput { return v.Scopes }).(pulumi.StringArrayOutput)
}

// The pattern used when matching against the `sub` claim from an OIDC identity token. Patterns can include `*` characters to match against any character.
func (o FederatedIdentityOutput) Subject() pulumi.StringOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringOutput { return v.Subject }).(pulumi.StringOutput)
}

// A list of tags that access tokens generated for the federated identity will be able to assign to devices. Mandatory if the scopes include "devices:core" or "authKeys".
func (o FederatedIdentityOutput) Tags() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringArrayOutput { return v.Tags }).(pulumi.StringArrayOutput)
}

// The updated timestamp of the key in RFC3339 format
func (o FederatedIdentityOutput) UpdatedAt() pulumi.StringOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringOutput { return v.UpdatedAt }).(pulumi.StringOutput)
}

// ID of the user who created this federated identity, empty for federated identities created by other trust credentials.
func (o FederatedIdentityOutput) UserId() pulumi.StringOutput {
	return o.ApplyT(func(v *FederatedIdentity) pulumi.StringOutput { return v.UserId }).(pulumi.StringOutput)
}

type FederatedIdentityArrayOutput struct{ *pulumi.OutputState }

func (FederatedIdentityArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*FederatedIdentity)(nil)).Elem()
}

func (o FederatedIdentityArrayOutput) ToFederatedIdentityArrayOutput() FederatedIdentityArrayOutput {
	return o
}

func (o FederatedIdentityArrayOutput) ToFederatedIdentityArrayOutputWithContext(ctx context.Context) FederatedIdentityArrayOutput {
	return o
}

func (o FederatedIdentityArrayOutput) Index(i pulumi.IntInput) FederatedIdentityOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *FederatedIdentity {
		return vs[0].([]*FederatedIdentity)[vs[1].(int)]
	}).(FederatedIdentityOutput)
}

type FederatedIdentityMapOutput struct{ *pulumi.OutputState }

func (FederatedIdentityMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*FederatedIdentity)(nil)).Elem()
}

func (o FederatedIdentityMapOutput) ToFederatedIdentityMapOutput() FederatedIdentityMapOutput {
	return o
}

func (o FederatedIdentityMapOutput) ToFederatedIdentityMapOutputWithContext(ctx context.Context) FederatedIdentityMapOutput {
	return o
}

func (o FederatedIdentityMapOutput) MapIndex(k pulumi.StringInput) FederatedIdentityOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *FederatedIdentity {
		return vs[0].(map[string]*FederatedIdentity)[vs[1].(string)]
	}).(FederatedIdentityOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*FederatedIdentityInput)(nil)).Elem(), &FederatedIdentity{})
	pulumi.RegisterInputType(reflect.TypeOf((*FederatedIdentityArrayInput)(nil)).Elem(), FederatedIdentityArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*FederatedIdentityMapInput)(nil)).Elem(), FederatedIdentityMap{})
	pulumi.RegisterOutputType(FederatedIdentityOutput{})
	pulumi.RegisterOutputType(FederatedIdentityArrayOutput{})
	pulumi.RegisterOutputType(FederatedIdentityMapOutput{})
}
