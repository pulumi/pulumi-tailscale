// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package tailscale

import (
	"context"
	"reflect"

	"github.com/pulumi/pulumi-tailscale/sdk/go/tailscale/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// The awsExternalId resource allows you to mint an AWS External ID that Tailscale can use to assume an AWS IAM role that you create for the purposes of allowing Tailscale to stream logs to your S3 bucket. See the logstreamConfiguration resource for more details.
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-aws/sdk/go/aws"
//	"github.com/pulumi/pulumi-tailscale/sdk/go/tailscale"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			prod, err := tailscale.NewAwsExternalId(ctx, "prod", nil)
//			if err != nil {
//				return err
//			}
//			tailscaleAssumeRole, err := aws.IamPolicyDocument(ctx, map[string]interface{}{
//				"statement": []map[string]interface{}{
//					map[string]interface{}{
//						"actions": []string{
//							"sts:AssumeRole",
//						},
//						"principals": []map[string]interface{}{
//							map[string]interface{}{
//								"type": "AWS",
//								"identifiers": pulumi.StringArray{
//									prod.TailscaleAwsAccountId,
//								},
//							},
//						},
//						"condition": []map[string]interface{}{
//							map[string]interface{}{
//								"test":     "StringEquals",
//								"variable": "sts:ExternalId",
//								"values": pulumi.StringArray{
//									prod.ExternalId,
//								},
//							},
//						},
//					},
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			logsWriterIamRole, err := aws.NewIamRole(ctx, "logs_writer", &aws.IamRoleArgs{
//				Name:             "logs-writer",
//				AssumeRolePolicy: tailscaleAssumeRole.Json,
//			})
//			if err != nil {
//				return err
//			}
//			_, err = tailscale.NewLogstreamConfiguration(ctx, "configuration_logs", &tailscale.LogstreamConfigurationArgs{
//				LogType:              pulumi.String("configuration"),
//				DestinationType:      pulumi.String("s3"),
//				S3Bucket:             pulumi.Any(tailscaleLogs.Id),
//				S3Region:             pulumi.String("us-west-2"),
//				S3AuthenticationType: pulumi.String("rolearn"),
//				S3RoleArn:            logsWriterIamRole.Arn,
//				S3ExternalId:         prod.ExternalId,
//			})
//			if err != nil {
//				return err
//			}
//			logsWriter, err := aws.IamPolicyDocument(ctx, map[string]interface{}{
//				"statement": []map[string]interface{}{
//					map[string]interface{}{
//						"effect": "Allow",
//						"actions": []string{
//							"s3:*",
//						},
//						"resources": []string{
//							"arn:aws:s3:::example-bucket",
//							"arn:aws:s3:::example-bucket/*",
//						},
//					},
//				},
//			}, nil)
//			if err != nil {
//				return err
//			}
//			_, err = aws.NewIamRolePolicy(ctx, "logs_writer", &aws.IamRolePolicyArgs{
//				Role:   logsWriterIamRole.Id,
//				Policy: logsWriter.Json,
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
type AwsExternalId struct {
	pulumi.CustomResourceState

	// The External ID that Tailscale will supply when assuming your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id*roles*common-scenarios_third-party.html for more information on external IDs.
	ExternalId pulumi.StringOutput `pulumi:"externalId"`
	// The AWS account from which Tailscale will assume your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id*roles*common-scenarios_third-party.html for more information on external IDs.
	TailscaleAwsAccountId pulumi.StringOutput `pulumi:"tailscaleAwsAccountId"`
}

// NewAwsExternalId registers a new resource with the given unique name, arguments, and options.
func NewAwsExternalId(ctx *pulumi.Context,
	name string, args *AwsExternalIdArgs, opts ...pulumi.ResourceOption) (*AwsExternalId, error) {
	if args == nil {
		args = &AwsExternalIdArgs{}
	}

	opts = internal.PkgResourceDefaultOpts(opts)
	var resource AwsExternalId
	err := ctx.RegisterResource("tailscale:index/awsExternalId:AwsExternalId", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetAwsExternalId gets an existing AwsExternalId resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetAwsExternalId(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *AwsExternalIdState, opts ...pulumi.ResourceOption) (*AwsExternalId, error) {
	var resource AwsExternalId
	err := ctx.ReadResource("tailscale:index/awsExternalId:AwsExternalId", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering AwsExternalId resources.
type awsExternalIdState struct {
	// The External ID that Tailscale will supply when assuming your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id*roles*common-scenarios_third-party.html for more information on external IDs.
	ExternalId *string `pulumi:"externalId"`
	// The AWS account from which Tailscale will assume your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id*roles*common-scenarios_third-party.html for more information on external IDs.
	TailscaleAwsAccountId *string `pulumi:"tailscaleAwsAccountId"`
}

type AwsExternalIdState struct {
	// The External ID that Tailscale will supply when assuming your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id*roles*common-scenarios_third-party.html for more information on external IDs.
	ExternalId pulumi.StringPtrInput
	// The AWS account from which Tailscale will assume your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id*roles*common-scenarios_third-party.html for more information on external IDs.
	TailscaleAwsAccountId pulumi.StringPtrInput
}

func (AwsExternalIdState) ElementType() reflect.Type {
	return reflect.TypeOf((*awsExternalIdState)(nil)).Elem()
}

type awsExternalIdArgs struct {
}

// The set of arguments for constructing a AwsExternalId resource.
type AwsExternalIdArgs struct {
}

func (AwsExternalIdArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*awsExternalIdArgs)(nil)).Elem()
}

type AwsExternalIdInput interface {
	pulumi.Input

	ToAwsExternalIdOutput() AwsExternalIdOutput
	ToAwsExternalIdOutputWithContext(ctx context.Context) AwsExternalIdOutput
}

func (*AwsExternalId) ElementType() reflect.Type {
	return reflect.TypeOf((**AwsExternalId)(nil)).Elem()
}

func (i *AwsExternalId) ToAwsExternalIdOutput() AwsExternalIdOutput {
	return i.ToAwsExternalIdOutputWithContext(context.Background())
}

func (i *AwsExternalId) ToAwsExternalIdOutputWithContext(ctx context.Context) AwsExternalIdOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AwsExternalIdOutput)
}

// AwsExternalIdArrayInput is an input type that accepts AwsExternalIdArray and AwsExternalIdArrayOutput values.
// You can construct a concrete instance of `AwsExternalIdArrayInput` via:
//
//	AwsExternalIdArray{ AwsExternalIdArgs{...} }
type AwsExternalIdArrayInput interface {
	pulumi.Input

	ToAwsExternalIdArrayOutput() AwsExternalIdArrayOutput
	ToAwsExternalIdArrayOutputWithContext(context.Context) AwsExternalIdArrayOutput
}

type AwsExternalIdArray []AwsExternalIdInput

func (AwsExternalIdArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*AwsExternalId)(nil)).Elem()
}

func (i AwsExternalIdArray) ToAwsExternalIdArrayOutput() AwsExternalIdArrayOutput {
	return i.ToAwsExternalIdArrayOutputWithContext(context.Background())
}

func (i AwsExternalIdArray) ToAwsExternalIdArrayOutputWithContext(ctx context.Context) AwsExternalIdArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AwsExternalIdArrayOutput)
}

// AwsExternalIdMapInput is an input type that accepts AwsExternalIdMap and AwsExternalIdMapOutput values.
// You can construct a concrete instance of `AwsExternalIdMapInput` via:
//
//	AwsExternalIdMap{ "key": AwsExternalIdArgs{...} }
type AwsExternalIdMapInput interface {
	pulumi.Input

	ToAwsExternalIdMapOutput() AwsExternalIdMapOutput
	ToAwsExternalIdMapOutputWithContext(context.Context) AwsExternalIdMapOutput
}

type AwsExternalIdMap map[string]AwsExternalIdInput

func (AwsExternalIdMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*AwsExternalId)(nil)).Elem()
}

func (i AwsExternalIdMap) ToAwsExternalIdMapOutput() AwsExternalIdMapOutput {
	return i.ToAwsExternalIdMapOutputWithContext(context.Background())
}

func (i AwsExternalIdMap) ToAwsExternalIdMapOutputWithContext(ctx context.Context) AwsExternalIdMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AwsExternalIdMapOutput)
}

type AwsExternalIdOutput struct{ *pulumi.OutputState }

func (AwsExternalIdOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**AwsExternalId)(nil)).Elem()
}

func (o AwsExternalIdOutput) ToAwsExternalIdOutput() AwsExternalIdOutput {
	return o
}

func (o AwsExternalIdOutput) ToAwsExternalIdOutputWithContext(ctx context.Context) AwsExternalIdOutput {
	return o
}

// The External ID that Tailscale will supply when assuming your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id*roles*common-scenarios_third-party.html for more information on external IDs.
func (o AwsExternalIdOutput) ExternalId() pulumi.StringOutput {
	return o.ApplyT(func(v *AwsExternalId) pulumi.StringOutput { return v.ExternalId }).(pulumi.StringOutput)
}

// The AWS account from which Tailscale will assume your role. You must reference this in your IAM role's trust policy. See https://docs.aws.amazon.com/IAM/latest/UserGuide/id*roles*common-scenarios_third-party.html for more information on external IDs.
func (o AwsExternalIdOutput) TailscaleAwsAccountId() pulumi.StringOutput {
	return o.ApplyT(func(v *AwsExternalId) pulumi.StringOutput { return v.TailscaleAwsAccountId }).(pulumi.StringOutput)
}

type AwsExternalIdArrayOutput struct{ *pulumi.OutputState }

func (AwsExternalIdArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*AwsExternalId)(nil)).Elem()
}

func (o AwsExternalIdArrayOutput) ToAwsExternalIdArrayOutput() AwsExternalIdArrayOutput {
	return o
}

func (o AwsExternalIdArrayOutput) ToAwsExternalIdArrayOutputWithContext(ctx context.Context) AwsExternalIdArrayOutput {
	return o
}

func (o AwsExternalIdArrayOutput) Index(i pulumi.IntInput) AwsExternalIdOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *AwsExternalId {
		return vs[0].([]*AwsExternalId)[vs[1].(int)]
	}).(AwsExternalIdOutput)
}

type AwsExternalIdMapOutput struct{ *pulumi.OutputState }

func (AwsExternalIdMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*AwsExternalId)(nil)).Elem()
}

func (o AwsExternalIdMapOutput) ToAwsExternalIdMapOutput() AwsExternalIdMapOutput {
	return o
}

func (o AwsExternalIdMapOutput) ToAwsExternalIdMapOutputWithContext(ctx context.Context) AwsExternalIdMapOutput {
	return o
}

func (o AwsExternalIdMapOutput) MapIndex(k pulumi.StringInput) AwsExternalIdOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *AwsExternalId {
		return vs[0].(map[string]*AwsExternalId)[vs[1].(string)]
	}).(AwsExternalIdOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*AwsExternalIdInput)(nil)).Elem(), &AwsExternalId{})
	pulumi.RegisterInputType(reflect.TypeOf((*AwsExternalIdArrayInput)(nil)).Elem(), AwsExternalIdArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*AwsExternalIdMapInput)(nil)).Elem(), AwsExternalIdMap{})
	pulumi.RegisterOutputType(AwsExternalIdOutput{})
	pulumi.RegisterOutputType(AwsExternalIdArrayOutput{})
	pulumi.RegisterOutputType(AwsExternalIdMapOutput{})
}
